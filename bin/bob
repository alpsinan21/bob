#!/usr/bin/env node

var DEFAULT_ENV = 'development',
    fs = require('fs'),
    path = require('path'),
    Bob = require('../lib/bob').Bob,
    Toolbelt = require('../lib/toolbelt').Toolbelt,
    appDir = process.cwd(),
    bobDir = path.join(__dirname, '..'),
    conf = JSON.parse(fs.readFileSync('package.json')),
    toolbelt = new Toolbelt(),
    bob = new Bob(toolbelt, conf),
    params = [
        { name: 'BOB_DIR', defaultVal: bobDir },
        { name: 'APP_DIR', defaultVal: appDir },
        { name: 'NODE_ENV', defaultVal: (process.env.NODE_ENV || DEFAULT_ENV) },
        { name: 'NAME' },
        { name: 'VERSION' },
        { name: 'BOB_SRC_DIR', defaultVal: '.' },
        { name: 'BOB_CHECKSTYLE_FILES', defaultVal: 'lib/ test/' },
        { name: 'BOB_CHECKSTYLE_OPTS', defaultVal: '--violations' },
        { name: 'BOB_HINT_FILES', defaultVal: 'lib/ test/' },
        { name: 'BOB_HINT_OPTS' },
        { name: 'BOB_LINT_FILES', defaultVal: 'lib/ test/' },
        { name: 'BOB_LINT_OPTS' },
        { name: 'BOB_TEST_FILES', defaultVal: 'test/*.js' },
        { name: 'BOB_TEST_OPTS', defaultVal: '--spec' },
        { name: 'BOB_COVERAGE_FILES', defaultVal: 'test/*.js' },
        { name: 'BOB_COVERAGE_OPTS', defaultVal: '--silent --cover-plain' },
        { name: 'BOB_DEPLOY_HOST' },
        { name: 'BOB_DEPLOY_PORT' },
        { name: 'BOB_DEPLOY_DIR' }
    ];

bob.build(bobDir, params, process.argv.slice(2));